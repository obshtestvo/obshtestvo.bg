
----------------
**UNDER HEAVY DEVELOPMENT. DO NOT USED UNTIL STABLE.**
----------------

Requires node 5+.

```ssh
git clone https://github.com/obshtestvo/obshtestvo.bg -b reborn --single-branch
npm install
npm start
# visit http://localhost:8080/
```

- `src` is the project-specific code. [`obshtestvo-ui`](obshtestvo-ui/README.md#readme) includes attempts for standalone modules derived during development.
- dig in: [`src/app.jsx`](src/app.jsx).


## What's included

### Architecture and conventions

- **NPM** is used for **dependency** management 
- Project is **backend-agnostic**. It doesn't depend on any backend framework or language
- It uses **`JSX` components** with custom control structures - `<If>`, `<For>` for sane templating.
- Everything is modular. All files related to a single `JSX` component 
  (styling, template, script, etc) are encapsulated. If logic is shared it's extracted into well-named module.
  No modules like `utils` or `shared`.
- It's written in **ES6** and has `import` resolution. Old or global libraries can also be mapped to the `import` resolution.
- The **`import` resolution** also works for different file types:
  - `SVG`s can be `import`-ed. The result of the import is `JSX` component. Useful as svg icons are preferred instead of icon fonts or raster images.
  - images (*png, jpg, gif*) can be `import`-ed. Small images are inlined via `data:`. Large images are copied.
    The result of the import is file path to the image
- There is **no CSS clashes** thanks to **CSSModules* which auto-generates unique classnames.
  Never use tag name for styling again. 
- **Styling variations** are done **via attributes** (`[size=large]`), not via classes.
  Adding more and more classes is confusing.
- **Readability & perceived performance** are favoured over code optimisation. Performance can be 
  achieved through librarie, best practices and creating a user feeling of a responsive system.
- **SCSS** is used for pre-processing styling. PostCSS is not used as it's not mature enough yet.
- Templates of `JSX` components that are not one-liners are extracted in a separate file.
- **Lowercase naming with dashes** (same as `npm`) is preferred to camelCase.
- **Single source of truth** for all data in the application. When this data source changes, the application is rerendered (optmized via vdom)
- **Routing** is very simple and fits the **single source of truth** model. It's just <Link> elements
  that dispatch events and if any subscribers change the data, the app is rerendered. No routing packages required.
- **Route configuration** is expected to be generated by the backend and provided as json object. [`src/urls.js`](src/urls.js) is an example.

### Development usability

> npm start

- **Embedded dev server** for development with **hot-reloading** (*no refresh needed for 
  CSS and component changes*). 
- **Compilation is fast**, compilation on changes is **almost instant**. 
- **Source mapping**
- **Linting** via eslint (*turnted off during sandbox mode which is what it is now*)
- No need to type browser prefixes for CSS. **All styling is autoprefixed**

### Optimizations

> npm run build

 - All separate styling files are combined into a single file
 - All separate script files are combined into 3 files:
   - srcipt file for long-term caching containing all base dependencies
   - script file that in the header section to precede all styling and dom
   - script file for the main application logic
 - Small images are embedded as `data:` uris
 - Fonts are embedded `data:` woff uris
 - Javascript and CSS are highly compressed
 - Modernizr is configured so that only what's required is included (*via [`.modernizrrc`](.modernizrrc)*)


## Developed with UX in mind
 - The project can detect when custom fonts are loaded. Loader animation must be shown before that. Avoids FOUC.
 - Project can detect when all dom and styling are applied. Loader animation must be shown before that. Avoids FOUC.
 - Switching content (*even with different height*) can be done via the `<AnimationSwitch>` component - **NOT YET FINISHED** 